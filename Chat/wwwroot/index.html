<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Chat</title>
</head>
<body>
    <div class="container">
        <ul id="message_list" class="chat_list"></ul>
        <input type="text" placeholder="Enter name here" id="name_input" />
        <input type="text" placeholder="Message" id="message_input" />
        <input type="button" id="send_button" value="Send Message" />
    </div>


    <script src="/js/signalr.js"></script>
    <script>
        var connection = new signalR.HubConnectionBuilder().withUrl("/chatHub").build();

        document.getElementById("send_button").disabled = true;

        connection.start().then(function () {
            document.getElementById("send_button").disabled = false;
        });

        connection.on("ReceiveMessage", function (message) {
            addMessage(message.user, message.userMessage, false)
        })

        document.getElementById("send_button").addEventListener("click", function (event) {
            var userName = document.getElementById("name_input").value;
            var message = document.getElementById("message_input").value;

            connection.invoke("SendMessage", userName, message);
            addMessage("You", message, true)
        })


        var addMessage = function (user, message, ownMessage) {
            var container = document.createElement("div");
            var messageContainer = document.createElement("div");
            var userMessage = document.createElement("li");
            var name = document.createElement("div");
            var messageList = document.getElementById("message_list");

            if (ownMessage)
            {
                messageContainer.classList.add("message_self");
                container.classList.add("message_container_self");
            }
            else
            {
                messageContainer.classList.add("message_other");
                container.classList.add("message_container_other");
            }

            name.classList.add("message_name");

            userMessage.textContent = message;
            name.textContent = user;

            messageContainer.appendChild(userMessage);

            container.appendChild(name);
            container.appendChild(messageContainer);

            messageList.appendChild(container);
            messageList.scrollTop = messageList.scrollHeight;
        }
    </script>
</body>
</html>
<style>
    .container {
        align-content: center;
        justify-content: center;
        margin: auto;
        width: 500px;
        padding: 100px;
    }

    .message_self {
        display: block;
        background-color: cornflowerblue;
        color: white;
        border-radius: 10px;
        padding: 10px;
        width: auto;
        margin-bottom: 5px;
        max-width: 200px;
    }

    .message_other {
        background-color: darkgrey;
        color: white;
        border-radius: 10px;
        padding: 10px;
        width: auto;
        max-width: 200px;
    }

    .message_name {
        color: gray;
        margin-left: 5px;
    }

    .message_container_other {
        display: inline-block;
        clear: both;
        float: right;
    }

    .message_container_self {
        display: inline-block;
        clear: both;
        float: left;
    }

    .chat_list {
        list-style-type: none;
        width: 300px;
        height: 500px;
        overflow: auto;
    }

</style>